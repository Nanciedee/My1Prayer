<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ma RÃ©flexion Matinale</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Great+Vibes&family=Delius&family=Lato:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { background-color: #FFF5E1; font-family: 'Lato', sans-serif; color: #4A4A4A; min-height: 100vh; padding: 1rem; }
        .glass { background: rgba(255, 255, 255, 0.4); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.6); border-radius: 2.5rem; }
        .paper { background-color: #fdfaf0; border: 1px solid #faedcd; border-radius: 1.5rem; }
        .serif { font-family: 'Playfair Display', serif; color: #1e1b4b; }
        .handwritten { font-family: 'Great Vibes', cursive; color: #b45309; font-size: 3.5rem; }
        .scripture { font-family: 'Delius', cursive; }
        canvas { background: white; border: 2px dashed #cbd5e1; border-radius: 1.5rem; cursor: crosshair; touch-action: none; }
        .mood-btn { font-size: 3rem; transition: transform 0.2s; cursor: pointer; opacity: 0.6; }
        .mood-btn:hover { transform: scale(1.2); opacity: 1; }
        .active-mood { transform: scale(1.3); opacity: 1; filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.4)); }
        .history-card { background: rgba(255,255,255,0.5); border-radius: 1rem; padding: 10px; text-align: center; border: 1px solid white; }
    </style>
</head>
<body class="flex flex-col items-center">

    <div class="max-w-5xl w-full glass p-6 md:p-12 shadow-2xl my-6">
        
        <div class="text-center mb-10">
            <h1 class="handwritten">RÃ©flexion Matinale</h1>
            <p class="serif uppercase tracking-widest text-xs font-bold">Mon Suivi de Paix IntÃ©rieure</p>
        </div>

        <div class="grid md:grid-cols-2 gap-8">
            <div class="space-y-6">
                <div class="paper p-6 text-center shadow-sm border-l-4 border-amber-400">
                    <h3 class="serif font-bold uppercase text-xs mb-3 flex justify-center gap-2"><i data-lucide="quote" size="18"></i> Verset</h3>
                    <p class="scripture text-lg italic text-gray-700">"Ne vous inquiÃ©tez de rien ; mais en toute chose faites connaÃ®tre vos besoins Ã  Dieu..."</p>
                    <p class="text-right text-xs mt-2 font-bold text-amber-700 italic">Phil 4:6</p>
                </div>

                <div class="p-6 bg-white/30 rounded-[2rem] border border-white/50">
                    <h3 class="serif font-bold uppercase text-xs mb-3 flex gap-2"><i data-lucide="pen-tool" size="18"></i> Ma PriÃ¨re</h3>
                    <textarea id="prayerText" oninput="saveData()" class="w-full h-44 bg-transparent border-none focus:ring-0 text-gray-700 scripture text-lg" placeholder="Seigneur..."></textarea>
                </div>
            </div>

            <div class="space-y-6">
                <div class="p-6 bg-white/30 rounded-[2rem] border border-white/50 text-center">
                    <h3 class="serif font-bold uppercase text-xs mb-4">Comment est mon cÅ“ur aujourd'hui ?</h3>
                    <div class="flex justify-around mb-6">
                        <span onclick="setMood('ðŸ¤©', this)" class="mood-btn">ðŸ¤©</span>
                        <span onclick="setMood('âœ¨', this)" class="mood-btn">âœ¨</span>
                        <span onclick="setMood('ðŸ’›', this)" class="mood-btn">ðŸ’›</span>
                        <span onclick="setMood('ðŸ˜„', this)" class="mood-btn">ðŸ˜„</span>
                        <span onclick="setMood('ðŸ˜”', this)" class="mood-btn">ðŸ˜”</span>
                        <span onclick="setMood('ðŸ˜´', this)" class="mood-btn">ðŸ˜´</span>
                    </div>
                    
                    <h4 class="serif font-bold uppercase text-[10px] mb-3 tracking-widest text-indigo-400">Progression de la semaine</h4>
                    <div id="weeklyHistory" class="grid grid-cols-7 gap-2">
                        </div>
                </div>

                <div class="p-6 bg-white/30 rounded-[2rem] border border-white/50">
                    <h3 class="serif font-bold uppercase text-xs mb-3 flex gap-2"><i data-lucide="heart" size="18"></i> Gratitude</h3>
                    <textarea id="gratitudeText" oninput="saveData()" class="w-full h-28 bg-transparent border-none focus:ring-0 text-gray-700 italic scripture text-lg" placeholder="Merci pour..."></textarea>
                </div>
            </div>
        </div>

        <div class="mt-10 space-y-4">
            <div class="flex justify-between items-center">
                <h3 class="serif font-bold uppercase text-xs flex gap-2 items-center"><i data-lucide="palette" size="20"></i> Espace Visuel</h3>
                <button onclick="clearCanvas()" class="text-[10px] font-bold text-red-500 uppercase">Effacer</button>
            </div>
            <canvas id="canvas" class="w-full h-48 shadow-inner"></canvas>
        </div>
    </div>

    <script>
        lucide.createIcons();
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let drawing = false;

        // --- LOGIQUE D'ENREGISTREMENT ---
        let journalData = JSON.parse(localStorage.getItem('my1prayer_data')) || {};
        const today = new Date().toISOString().split('T')[0];

        function saveData() {
            if(!journalData[today]) journalData[today] = {};
            journalData[today].prayer = document.getElementById('prayerText').value;
            journalData[today].gratitude = document.getElementById('gratitudeText').value;
            localStorage.setItem('my1prayer_data', JSON.stringify(journalData));
        }

        function setMood(mood, el) {
            document.querySelectorAll('.mood-btn').forEach(m => m.classList.remove('active-mood'));
            el.classList.add('active-mood');
            
            if(!journalData[today]) journalData[today] = {};
            journalData[today].mood = mood;
            localStorage.setItem('my1prayer_data', JSON.stringify(journalData));
            updateHistory();
        }

        function updateHistory() {
            const historyDiv = document.getElementById('weeklyHistory');
            historyDiv.innerHTML = '';
            
            for (let i = 6; i >= 0; i--) {
                const d = new Date();
                d.setDate(d.getDate() - i);
                const dateKey = d.toISOString().split('T')[0];
                const dayName = d.toLocaleDateString('fr-FR', { weekday: 'short' });
                const savedMood = journalData[dateKey]?.mood || 'â€¢';
                
                historyDiv.innerHTML += `
                    <div class="history-card ${dateKey === today ? 'border-amber-400 bg-amber-50' : ''}">
                        <div class="text-[9px] uppercase font-bold text-indigo-300">${dayName}</div>
                        <div class="text-xl">${savedMood}</div>
                    </div>
                `;
            }
        }

        function loadToday() {
            if(journalData[today]) {
                document.getElementById('prayerText').value = journalData[today].prayer || '';
                document.getElementById('gratitudeText').value = journalData[today].gratitude || '';
                if(journalData[today].mood) {
                    const btns = document.querySelectorAll('.mood-btn');
                    btns.forEach(b => { if(b.innerText === journalData[today].mood) b.classList.add('active-mood'); });
                }
            }
            updateHistory();
        }

        // --- LOGIQUE DESSIN ---
        function initCanvas() {
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            ctx.lineCap = 'round'; ctx.lineWidth = 3; ctx.strokeStyle = '#4f46e5';
        }
        canvas.onmousedown = (e) => { drawing = true; ctx.beginPath(); ctx.moveTo(e.offsetX, e.offsetY); };
        canvas.onmousemove = (e) => { if(drawing) { ctx.lineTo(e.offsetX, e.offsetY); ctx.stroke(); } };
        window.onmouseup = () => drawing = false;
        function clearCanvas() { ctx.clearRect(0,0,canvas.width,canvas.height); }

        window.onload = () => { initCanvas(); loadToday(); };
    </script>
</body>
</html>
